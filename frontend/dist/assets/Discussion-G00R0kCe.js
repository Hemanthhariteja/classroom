import{u as l,r as o,j as e,e as d}from"./index-D9lXXRMH.js";import{b as x}from"./offline-D748ZU6k.js";function p(){const{id:t}=l(),[c,n]=o.useState([]),[a,i]=o.useState("");o.useEffect(()=>{fetch("/mock/discussion.json").then(s=>s.json()).then(s=>n(s.data||[]))},[t]);const r=async()=>{const s={classId:t,text:a,createdAt:Date.now()};n([...c,{id:`tmp-${s.createdAt}`,author:"You",text:s.text,createdAt:s.createdAt}]),i("");try{if(!(await fetch(`/api/classes/${t}/discussion`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s.text})})).ok)throw new Error("offline?")}catch{await x(s)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"btn-ghost",onClick:()=>window.history.back(),children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Discussion Board"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto card p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Discussion Board"}),e.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto scrollbar-thin",children:c.map(s=>e.jsxs("div",{className:"border border-border rounded p-2",children:[e.jsx("div",{className:"text-xs text-textMuted",children:new Date(s.createdAt).toLocaleString()}),e.jsxs("div",{children:[s.author?e.jsxs("span",{className:"text-accent",children:[s.author,": "]}):null,s.text]})]},s.id))}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("input",{className:"input flex-1",value:a,placeholder:"Type message…",onChange:s=>i(s.target.value)}),e.jsx("button",{className:"btn",onClick:r,disabled:!a.trim(),children:"Post"})]}),e.jsx("p",{className:"text-xs text-textMuted mt-2",children:"Works offline: posts will sync when back online."})]}),e.jsx(d,{})]})}export{p as default};
