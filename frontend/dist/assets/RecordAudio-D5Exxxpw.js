import{r as a,j as e,c as N}from"./index-D9lXXRMH.js";function w(){const[r]=a.useState("68cced26157d87e24fee03ce"),[d,u]=a.useState("0"),[o,x]=a.useState(null),i=a.useRef([]),[m,l]=a.useState("Idle"),[c,p]=a.useState(""),b=async()=>{const n=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),t=new MediaRecorder(n,{mimeType:"audio/webm;codecs=opus"});t.ondataavailable=s=>i.current.push(s.data),t.onstop=()=>{const s=new Blob(i.current,{type:"audio/ogg"});i.current=[],p(URL.createObjectURL(s))},t.start(),x(t),l("Recording...")},h=async()=>{o==null||o.stop(),l("Stopped")},j=async()=>{if(!c)return;const t=await(await fetch(c)).blob(),s=new FormData;s.append("slideIndex",d),s.append("audio",t,`slide-${d}.ogg`),l("Uploading...");const f=await N.upload(`/classes/${r}/slide-audio`,s);l(f.status==="ok"?"Uploaded!":"Failed")};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"btn-ghost",onClick:()=>window.history.back(),children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Record Audio"})]}),e.jsxs("div",{className:"max-w-xl mx-auto card p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Record per-slide audio"}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm text-textMuted",children:"Slide Index (0, 1, 2...)"}),e.jsx("input",{className:"input w-full",value:d,onChange:n=>u(n.target.value)})]}),o?e.jsx("button",{className:"btn",onClick:h,children:"Stop"}):e.jsx("button",{className:"btn",onClick:b,children:"Start"}),e.jsx("button",{className:"btn",onClick:j,disabled:!c,children:"Upload"})]}),e.jsxs("p",{className:"text-sm text-textMuted mt-3",children:["Status: ",m]}),c&&e.jsx("audio",{className:"mt-3 w-full",controls:!0,src:c})]})]})}export{w as default};
